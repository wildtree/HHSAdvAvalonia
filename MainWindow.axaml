<rxui:ReactiveWindow xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:HHSAdvAvalonia.ViewModels"
        xmlns:rxui="clr-namespace:Avalonia.ReactiveUI;assembly=Avalonia.ReactiveUI"
        x:Class="HHSAdvAvalonia.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        x:TypeArguments="vm:MainWindowViewModel"
        DataContext="{Binding RelativeSource={RelativeSource Self}, Path=ViewModel}"
        Title="ハイハイスクールアドベンチャー"
        Icon="/assets/isako.ico"
        Width="{Binding ApplicationWidth, Mode=TwoWay}" Height="{Binding ApplicationHeight, Mode=TwoWay}"
        Opened="OnOpened"
        Closed="OnClosed">
    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

  <Grid>
    <!-- DockPanel 全体をメインレイアウトとして配置 -->
    <DockPanel>
      <!-- メニューバー -->
      <Menu DockPanel.Dock="Top">
        <MenuItem Header="_ファイル">
          <MenuItem Header="設定" Click="File_Settings_Clicked"/>
          <MenuItem Header="終了" Click="Menu_Quit_Clicked"/>
        </MenuItem>
        <MenuItem Header="_ヘルプ">
          <MenuItem Header="このアプリについて" Click="Help_About_Clicked"/>
        </MenuItem>
      </Menu>

      <!-- メインコンテンツ -->
      <Grid Margin="10" RowDefinitions="*, Auto, *">
        <!-- プログラムで生成したビットマップを表示する領域 -->
        <Image x:Name="Screen" Grid.Row="0" Stretch="Uniform" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

        <!-- 一行入力ウィジェット -->
        <StackPanel Grid.Row="1" Spacing="10" Margin="0, 5, 0, 5">
          <TextBox x:Name="InputArea" Watermark="どうする？" HorizontalAlignment="Stretch"/>
          <TextBlock x:Name="HitAnyKey" Text="何かキーを押してください..." IsVisible="False" HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- スクロール可能なテキストビュー -->
        <ScrollViewer x:Name="ScrollArea"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled" Grid.Row="2">
          <TextBlock x:Name="LogArea" TextWrapping="Wrap" FontSize="{Binding ApplicationFontSize, Mode=OneWay}"
                     Foreground="{DynamicResource ForegroundBrush}"
                     Background="{DynamicResource BackgroundBrush}"
                     FontFamily="Meiryo UI, Meiryo, Yu Gothic, YuGothic, 'Yu Gothic UI', sans-serif">

          </TextBlock>
        </ScrollViewer>
      </Grid>
    </DockPanel>

    <!-- ▼ クレジットロール用オーバーレイ -->
    <Border x:Name="RollOverlay"
            Background="#C0000000"
            IsVisible="False">
      <Canvas>
        <Image x:Name="RollCreditsImage">
          <Image.RenderTransform>
            <TranslateTransform/>
          </Image.RenderTransform>
        </Image>
      </Canvas>
    </Border>
  </Grid>
</rxui:ReactiveWindow>